@model HelloWorld.NetCore.Models.QuizResultViewModel
@{
    ViewData["Title"] = "Quiz Results";
}

<div style="max-width: 1000px; margin: 30px auto; padding: 30px; background-color: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
    <h1 style="color: #0078d4; text-align: center;">Quiz Complete! ðŸŽ‰</h1>
    
    <!-- Score Summary -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 40px 0;">
        <div style="text-align: center; padding: 25px; background-color: @(Model.ScorePercentage >= 70 ? "#d4edda" : "#f8d7da"); border-radius: 10px;">
            <h2 style="margin: 0; font-size: 48px; color: @(Model.ScorePercentage >= 70 ? "#155724" : "#721c24");">@Model.ScorePercentage%</h2>
            <p style="margin: 10px 0 0 0; color: #666;">Your Score</p>
        </div>
        
        <div style="text-align: center; padding: 25px; background-color: #d1ecf1; border-radius: 10px;">
            <h2 style="margin: 0; font-size: 48px; color: #0c5460;">@Model.CorrectAnswers/@Model.TotalQuestions</h2>
            <p style="margin: 10px 0 0 0; color: #666;">Correct Answers</p>
        </div>
        
        <div style="text-align: center; padding: 25px; background-color: #fff3cd; border-radius: 10px;">
            <h2 style="margin: 0; font-size: 48px; color: #856404;">@Model.TimeTaken.Minutes:@Model.TimeTaken.Seconds.ToString("00")</h2>
            <p style="margin: 10px 0 0 0; color: #666;">Time Taken</p>
        </div>
    </div>

    @if (Model.ScorePercentage >= 70)
    {
        <div style="padding: 20px; background-color: #d4edda; border-left: 4px solid #28a745; border-radius: 4px; margin: 30px 0;">
            <h3 style="color: #155724; margin-top: 0;">âœ“ Great Job!</h3>
            <p style="color: #155724; margin: 0;">You're on track for the AZ-204 exam. Keep practicing!</p>
        </div>
    }
    else
    {
        <div style="padding: 20px; background-color: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px; margin: 30px 0;">
            <h3 style="color: #856404; margin-top: 0;">Keep Practicing!</h3>
            <p style="color: #856404; margin: 0;">Review the explanations below and try again to improve your score.</p>
        </div>
    }

    <!-- Detailed Results -->
    <h2 style="color: #333; margin-top: 40px; padding-bottom: 10px; border-bottom: 2px solid #e9ecef;">Detailed Results</h2>
    
    @for (int i = 0; i < Model.QuestionResults.Count; i++)
    {
        var result = Model.QuestionResults[i];
        var question = result.Question;
        var isCorrect = result.IsCorrect;
        
        <div style="margin: 25px 0; padding: 25px; background-color: #f8f9fa; border-left: 4px solid @(isCorrect ? "#28a745" : "#dc3545"); border-radius: 8px;">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                <div>
                    <span style="background-color: @(isCorrect ? "#28a745" : "#dc3545"); color: white; padding: 4px 12px; border-radius: 12px; font-size: 14px; font-weight: bold;">
                        @(isCorrect ? "âœ“ Correct" : "âœ— Incorrect")
                    </span>
                    <span style="margin-left: 10px; background-color: #e7f3ff; color: #0078d4; padding: 4px 12px; border-radius: 12px; font-size: 14px;">
                        @question.Topic
                    </span>
                </div>
                <span style="color: #666; font-weight: bold;">Question @(i + 1)</span>
            </div>
            
            <h4 style="color: #333; margin: 15px 0;">@question.Question</h4>
            
            <div style="margin: 15px 0;">
                @for (int j = 0; j < question.Options.Count; j++)
                {
                    var optionStyle = "";
                    var optionLabel = "";
                    
                    if (j == question.CorrectAnswerIndex)
                    {
                        optionStyle = "background-color: #d4edda; border-color: #28a745; color: #155724;";
                        optionLabel = "âœ“ Correct Answer";
                    }
                    else if (j == result.UserAnswerIndex && !isCorrect)
                    {
                        optionStyle = "background-color: #f8d7da; border-color: #dc3545; color: #721c24;";
                        optionLabel = "âœ— Your Answer";
                    }
                    else
                    {
                        optionStyle = "background-color: white; border-color: #dee2e6; color: #333;";
                    }
                    
                    <div style="padding: 12px 15px; margin: 8px 0; border: 2px solid; border-radius: 6px; @optionStyle">
                        <strong>@((char)('A' + j)).</strong> @question.Options[j]
                        @if (!string.IsNullOrEmpty(optionLabel))
                        {
                            <span style="float: right; font-weight: bold;">@optionLabel</span>
                        }
                    </div>
                }
            </div>
            
            <div style="margin-top: 15px; padding: 15px; background-color: #e7f3ff; border-radius: 6px;">
                <strong style="color: #0078d4;">ðŸ’¡ Explanation:</strong>
                <p style="margin: 10px 0 0 0; color: #333;">@question.Explanation</p>
            </div>
        </div>
    }

    <!-- Action Buttons -->
    <div style="text-align: center; margin-top: 40px;">
        <form asp-action="Restart" method="post" style="display: inline-block;">
            <button type="submit" style="background-color: #0078d4; color: white; border: none; padding: 15px 40px; font-size: 18px; border-radius: 5px; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2); margin: 0 10px;">
                Take Quiz Again
            </button>
        </form>
        <a asp-controller="Home" asp-action="Index" style="display: inline-block; background-color: #6c757d; color: white; text-decoration: none; padding: 15px 40px; font-size: 18px; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); margin: 0 10px;">
            Back to Home
        </a>
    </div>
</div>
